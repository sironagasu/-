<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>æ±Ÿæˆ¸ã‚«ãƒ¼ãƒ‰ã§ç”ºã¥ãã‚Šï¼ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ç‰ˆï¼‰</title>
<style>
  :root{
    --edo-yellow:#FCD34D; --edo-info:#FFF8DC; --edo-border:#999;
    --bg:#FFF6E3; --shadow:rgba(0,0,0,.12); --ink:#222;
    --adbg:#f1f1f1;
  }
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--ink);
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,
      "Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic",Meiryo,sans-serif;}
  /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼š1ç”»é¢ï¼‹ä¸‹éƒ¨å›ºå®šãƒãƒŠãƒ¼ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã»ã¼ç„¡ã—ï¼‰ */
  .wrap{display:flex;flex-direction:column;min-height:100svh;}
  header{position:sticky;top:0;z-index:3;background:var(--edo-yellow);
    padding:10px 12px;display:flex;align-items:center;justify-content:space-between;
    box-shadow:0 1px 4px var(--shadow);}
  header h1{font-size:18px;margin:0;font-weight:700}
  header button{border:0;border-radius:10px;background:#fff;padding:6px 12px;
    font-weight:700;box-shadow:0 1px 3px var(--shadow);cursor:pointer}
  #info{padding:10px;background:var(--edo-info);border-bottom:1px solid #ccc;
    font-size:15px;min-height:40px}
  #town{position:relative;width:100%;height:44vh;min-height:260px;background:#fff;
    border-top:2px solid var(--edo-border);border-bottom:2px solid var(--edo-border);
    overflow:hidden}
  #cards{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;padding:10px}
  .card{width:28vw;max-width:110px;min-width:86px;height:120px;border-radius:12px;background:#ddd;
    display:flex;align-items:center;justify-content:center;font-weight:700;font-size:16px;
    cursor:pointer;box-shadow:0 2px 6px var(--shadow);user-select:none}
  .card.done{background:#cdeccd; color:#1a5e1a}
  .building{position:absolute;font-size:34px;opacity:0;transform:scale(.8);
    transition:opacity .7s, transform .7s}
  .show{opacity:1;transform:scale(1.2)}
  .villager{position:absolute;font-size:20px;animation:walk 8s linear infinite}
  @keyframes walk{0%{left:2%}50%{left:90%}100%{left:2%}}
  /* å›³é‘‘ãƒ‘ãƒãƒ«ï¼ˆç« ã”ã¨ï¼‰ */
  #zukanPanel{position:fixed;inset:0 0 auto 0;height:72%;top:-100%;background:#fff;
    border-bottom:3px solid #333;box-shadow:0 4px 16px var(--shadow);
    transition:top .45s ease;z-index:5;overflow:auto}
  #zukanPanel.active{top:0}
  #zukanHead{position:sticky;top:0;background:#fff;padding:10px;border-bottom:1px solid #eee;
    display:flex;align-items:center;gap:8px}
  #zukanHead h2{margin:0;font-size:18px}
  #closeZukan{margin-left:auto;border:0;background:#eee;border-radius:8px;padding:6px 12px;cursor:pointer}
  .zukanSec{padding:10px}
  .zukanSec h3{margin:8px 0}
  .zCard{display:inline-flex;align-items:center;justify-content:center;width:90px;height:110px;margin:4px;
    border:1px solid #ccc;border-radius:8px;box-shadow:0 1px 3px var(--shadow);white-space:pre-line}
  .locked{background:#eee;color:#999}
  #completeMsg{font-size:18px;font-weight:800;color:green;text-align:center;padding:10px}
  .petal{position:fixed;top:-10px;font-size:20px;animation:fall linear forwards;pointer-events:none}
  @keyframes fall{to{transform:translateY(110vh) rotate(360deg);opacity:0}}
  /* ä¸‹éƒ¨ã®â€œåºƒå‘Šæ â€ */
  .adbar{position:sticky;bottom:0;background:var(--adbg);border-top:1px solid #ddd;
    padding:4px 8px; display:flex; justify-content:center; align-items:center; min-height:52px}
  .adslot{width:100%; max-width:728px; height:50px; background:
    repeating-linear-gradient(45deg,#eee,#eee 8px,#e2e2e2 8px,#e2e2e2 16px);
    border:1px dashed #bbb;border-radius:8px; display:flex; align-items:center; justify-content:center;
    font-size:12px; color:#666}
  footer{height:8px}
  /* æ¨ªå‘ãã¯è­¦å‘Š */
  .landscapeWarn{position:fixed;inset:0;background:rgba(0,0,0,.65);color:#fff;display:none;
    align-items:center;justify-content:center;z-index:20;text-align:center;padding:20px}
  @media (orientation:landscape){
    .landscapeWarn{display:flex}
  }
</style>
</head>
<body>
<div class="wrap" role="application" aria-label="æ±Ÿæˆ¸ã‚«ãƒ¼ãƒ‰ã§ç”ºã¥ãã‚Š">
  <header>
    <h1>æ±Ÿæˆ¸ã‚«ãƒ¼ãƒ‰ã§ç”ºã¥ãã‚Šï¼</h1>
    <button id="zukanBtn" aria-controls="zukanPanel" aria-expanded="false">å›³é‘‘</button>
  </header>

  <div id="info">ã‚«ãƒ¼ãƒ‰ã‚’ã‚ãã£ã¦æ±Ÿæˆ¸ã®ç”ºã‚’ç™ºå±•ã•ã›ã‚ˆã†ï¼</div>
  <div id="town" role="img" aria-label="æ±Ÿæˆ¸ã®ç”ºã‚¨ãƒªã‚¢"></div>

  <div id="cards" aria-label="ã‚«ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢">
    <div class="card" data-card="æ±Ÿæˆ¸åŸ">ï¼Ÿ</div>
    <div class="card" data-card="å‚å‹¤äº¤ä»£">ï¼Ÿ</div>
    <div class="card" data-card="é–å›½">ï¼Ÿ</div>
    <div class="card" data-card="æ­Œèˆä¼">ï¼Ÿ</div>
    <div class="card" data-card="æµ®ä¸–çµµ">ï¼Ÿ</div>
    <div class="card" data-card="å¸‚å ´">ï¼Ÿ</div>
    <div class="card" data-card="é»’èˆ¹æ¥èˆª">ï¼Ÿ</div>
    <div class="card" data-card="é–‹å›½">ï¼Ÿ</div>
    <div class="card" data-card="æ˜æ²»ã¸">ï¼Ÿ</div>
  </div>

  <section id="zukanPanel" aria-hidden="true">
    <div id="zukanHead">
      <h2>æ±Ÿæˆ¸ã‚«ãƒ¼ãƒ‰å›³é‘‘ï¼ˆç« ã”ã¨ï¼‰</h2>
      <button id="closeZukan" aria-label="å›³é‘‘ã‚’ã¨ã˜ã‚‹">ã¨ã˜ã‚‹</button>
    </div>
    <div id="zukanList"></div>
    <div id="completeMsg"></div>
  </section>

  <div class="adbar" aria-label="åºƒå‘Šæ ">
    <div class="adslot">
      åºƒå‘Šã‚¹ãƒšãƒ¼ã‚¹ï¼ˆã“ã“ã‚’å¾Œã§ AdSense ã®ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆï¼‰
    </div>
  </div>
  <footer aria-hidden="true"></footer>
</div>

<div class="landscapeWarn">ç¸¦å‘ãã§éŠã‚“ã§ã­ğŸ”„</div>

<script>
  // ç« ã”ã¨ã®å­¦ç¿’ã‚«ãƒ¼ãƒ‰å®šç¾©
  const chapters = {
    "åˆæœŸ": {
      "æ±Ÿæˆ¸åŸ": { text: "å¾³å·å¹•åºœã®ä¸­å¿ƒã€æ±Ÿæˆ¸åŸãŒå®Œæˆï¼", icon: "ğŸ¯" },
      "å‚å‹¤äº¤ä»£": { text: "ãŠã¨ã®ã•ã¾ã¯æ±Ÿæˆ¸ã¨å›½ã‚’è¡Œã£ãŸã‚Šæ¥ãŸã‚Šã—ã¾ã—ãŸã€‚", icon: "ğŸš¶" },
      "é–å›½": { text: "å¤–å›½ã¨ã®äº¤æµã‚’åˆ¶é™ã—ã¾ã—ãŸã€‚", icon: "ğŸŒ" }
    },
    "ä¸­æœŸ": {
      "æ­Œèˆä¼": { text: "åº¶æ°‘ã«å¤§äººæ°—ï¼æ­Œèˆä¼å°å±‹ãŒç«‹ã¡ä¸¦ã³ã¾ã—ãŸã€‚", icon: "ğŸ­" },
      "æµ®ä¸–çµµ": { text: "èŠ¸è¡“ã®èŠ±ãŒå’²ã„ãŸï¼æµ®ä¸–çµµæ–‡åŒ–ã®ç™ºå±•ã€‚", icon: "ğŸ–¼ï¸" },
      "å¸‚å ´": { text: "ã«ãã‚„ã‹ãªå¸‚å ´ãŒã²ã‚‰ã‹ã‚Œã¾ã—ãŸï¼", icon: "ğŸ®" }
    },
    "å¹•æœ«": {
      "é»’èˆ¹æ¥èˆª": { text: "ãƒšãƒªãƒ¼æç£ãŒã‚„ã£ã¦ããŸï¼", icon: "â›´ï¸" },
      "é–‹å›½": { text: "ã¤ã„ã«ä¸–ç•Œã«é–€æˆ¸ã‚’é–‹ãã¾ã—ãŸã€‚", icon: "ğŸŒ" },
      "æ˜æ²»ã¸": { text: "æ™‚ä»£ã¯å¤‰ã‚ã‚Šã€æ˜æ²»ã¸ãƒãƒˆãƒ³ã‚¿ãƒƒãƒï¼", icon: "ğŸŒ¸" }
    }
  };

  const infoBox = document.getElementById("info");
  const town = document.getElementById("town");
  const zukanPanel = document.getElementById("zukanPanel");
  const zukanList = document.getElementById("zukanList");
  const completeMsg = document.getElementById("completeMsg");
  const zukanBtn = document.getElementById("zukanBtn");
  const closeZukan = document.getElementById("closeZukan");
  const gotCards = {};               // å–å¾—çŠ¶æ³
  const LS_KEY = "edoTown_cards";    // æ°¸ç¶šåŒ–ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ä¿å­˜ï¼‰

  // å–å¾—çŠ¶æ³ã®èª­ã¿è¾¼ã¿
  try {
    const saved = JSON.parse(localStorage.getItem(LS_KEY) || "{}");
    Object.assign(gotCards, saved);
  } catch(e){}

  // ã‚«ãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯
  document.querySelectorAll(".card").forEach(card=>{
    const name = card.dataset.card;
    if (gotCards[name]) { card.textContent = name; card.classList.add("done"); }
    card.addEventListener("click", ()=>{
      if (card.textContent !== "ï¼Ÿ") return; // æ—¢ã«ã‚ãã£ãŸ
      const data = findCardData(name); if(!data) return;

      // ã‚«ãƒ¼ãƒ‰è¡¨ã«
      card.textContent = name;
      card.classList.add("done");
      infoBox.textContent = data.text;

      // ç”ºã«å»ºç‰©/äººã‚’è¿½åŠ 
      const b = document.createElement("div");
      b.className = "building";
      b.textContent = data.icon;
      b.style.left = (Math.random()*80 + 5) + "%";
      b.style.top = (Math.random()*70 + 5) + "%";
      town.appendChild(b);
      setTimeout(()=>b.classList.add("show"),50);

      const v = document.createElement("div");
      v.className = "villager";
      v.textContent = Math.random()>0.5 ? "ğŸ˜Š" : "ğŸ‘˜";
      v.style.top = Math.floor(Math.random()* (town.clientHeight-40)) + "px";
      town.appendChild(v);

      gotCards[name] = true;
      persist();
      renderZukan();
    });
  });

  function persist(){
    try { localStorage.setItem(LS_KEY, JSON.stringify(gotCards)); } catch(e){}
  }

  function findCardData(name){
    for(const ch in chapters){ if(chapters[ch][name]) return chapters[ch][name]; }
    return null;
  }

  // å›³é‘‘æç”»
  function renderZukan(){
    zukanList.innerHTML = "";
    let allComplete = true;
    for(const ch in chapters){
      const section = document.createElement("div");
      section.className = "zukanSec";
      section.innerHTML = `<h3>${ch}</h3>`;
      for(const name in chapters[ch]){
        const div = document.createElement("div");
        div.className = "zCard";
        if(gotCards[name]){
          div.textContent = chapters[ch][name].icon + "\\n" + name;
          div.style.lineHeight = "normal";
        }else{
          div.textContent = "ï¼Ÿï¼Ÿï¼Ÿ";
          div.classList.add("locked");
          allComplete = false;
        }
        section.appendChild(div);
      }
      zukanList.appendChild(section);
    }
    if(allComplete){
      completeMsg.textContent = "ğŸ‰ æ±Ÿæˆ¸ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆï¼ãŠã‚ã§ã¨ã†ï¼ ğŸ‰";
      launchPetals();
    }else{
      completeMsg.textContent = "";
    }
  }

  // æ¡œãµã¶ã
  function launchPetals(){
    for(let i=0;i<24;i++){
      const p=document.createElement("div");
      p.className="petal";
      p.textContent="ğŸŒ¸";
      p.style.left = Math.random()*100 + "vw";
      p.style.animationDuration = (3 + Math.random()*3) + "s";
      document.body.appendChild(p);
      setTimeout(()=>p.remove(), 7000);
    }
  }

  // å›³é‘‘ã®é–‹é–‰
  zukanBtn.addEventListener("click", ()=>{
    const active = !zukanPanel.classList.contains("active");
    zukanPanel.classList.toggle("active");
    zukanPanel.setAttribute("aria-hidden", active ? "false" : "true");
    zukanBtn.setAttribute("aria-expanded", String(active));
  });
  closeZukan.addEventListener("click", ()=>{
    zukanPanel.classList.remove("active");
    zukanPanel.setAttribute("aria-hidden","true");
    zukanBtn.setAttribute("aria-expanded","false");
  });

  // åˆæœŸæç”»ï¼ˆä¿å­˜æ¸ˆã¿ã‚’ç”ºã«å†é…ç½®ï¼‰
  renderZukan();
  for(const name in gotCards){
    const data = findCardData(name);
    if(!data) continue;
    const card = [...document.querySelectorAll(".card")]
      .find(c=>c.dataset.card===name);
    if(card){ card.textContent=name; card.classList.add("done"); }
    const b = document.createElement("div");
    b.className = "building show";
    b.textContent = data.icon;
    b.style.left = (Math.random()*80 + 5) + "%";
    b.style.top = (Math.random()*70 + 5) + "%";
    town.appendChild(b);
    const v = document.createElement("div");
    v.className = "villager";
    v.textContent = Math.random()>0.5 ? "ğŸ˜Š" : "ğŸ‘˜";
    v.style.top = Math.floor(Math.random()* (town.clientHeight-40)) + "px";
    town.appendChild(v);
  }
</script>

<!-- âœ… å¾Œã§ã“ã“ã‚’æœ¬ç‰©ã®AdSenseã«å·®ã—æ›¿ãˆï¼ˆä¾‹ï¼‰ï¼š
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxxxxxxxxxxxx"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-xxxxxxxxxxxxxxxx"
     data-ad-slot="9999999999"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
-->
</body>
</html>
